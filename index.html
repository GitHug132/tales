<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Jasmine Spec for Tales v2.4.1</title>

  <link rel="shortcut icon" type="image/png" href="resources/jasmine-2.4.1/jasmine_favicon.png">
  <link rel="stylesheet" href="resources/jasmine-2.4.1/jasmine.css">

  <script src="resources/jasmine-2.4.1/jasmine.js"></script>
  <script src="resources/jasmine-2.4.1/jasmine-html.js"></script>
  <script src="resources/jasmine-2.4.1/boot.js"></script>

  <script src="src/parser.js"></script>
  <script src="spec/ParserSpec.js"></script>

</head>

<script>
  function executeContext(context) {
    console.log(context.title, context.description);
  }
  function runContext(items) {
    items.forEach((item) => {
      executeContext({ title: item.title, description: item.description });
      if (item.items) {
        if (item.items.length > 0) {
          runContext(item.items);
        }
      }
    });
  }

  function run(...arg) {
    arg.forEach((url) => {
      fetch(url).then((response) => {
        if (response.ok) {
          return response.text().then((text) => { return parse(text); });
        } else {
          throw new Error(`${response.url} ${response.statusText} (${response.status})`);
        }
      }).then((tale) => {
        runContext(tale);
      }, (error) => {
        throw error;
      });
    });
  }

  run('spec/fixtures/cuento1.tale');
  run('spec/fixtures/cuento2.tale', 'spec/fixtures/cuento3.tale');
</script>

<body>
</body>
</html>
